<div class="row">
	<div class="col-sm-3 col-md-2">
		<div id="listCntr" class="dark">
			<div class="overflow-view">
				<div ability-tree-view="treeView" data-click="treeItemClick" class="top-view"
					 data-file-menu="fileMenu" ng-class="{item: isItem}"
					 data-image-func="getIconList" data-active-func="isCurrentAbility"></div>
			</div>
		</div>

		<div id="btnGroup">
			<table>
				<tr>
					<td>
						<button class="btn btn-primary" ng-click="newTmplAbility()">+ {{::Locale('Ability')}}</button>
					</td>
					<td style="width: 5px;"></td>
					<td>
						<button class="btn btn-primary" ng-click="newGroup()">+ {{::Locale('Group')}}</button>
					</td>
				</tr>
			</table>
		</div>
	</div>
	<div class="col-sm-9 col-md-10" ng-show="!ready">
		<h1>{{::Locale('Loading')}}...</h1>
	</div>
	<div class="col-sm-9 col-md-10" ng-class="{abilityCntr: ready && !ability}" ng-show="ready && !ability">
		<h1>{{::Locale('emptyList')}}</h1>
	</div>
	<div class="col-sm-9 col-md-10" ng-class="{abilityCntr: ability}" ng-show="ability">
		<!-- ================================================================== -->
		<!-- =                            技能  引领                            = -->
		<!-- ================================================================== -->
		<div class="ability-cntr-header clearfix">
			<div class="ability-cntr-header-img">
				<img image class="ability-img" data-src-list="iconSrcList">
				<a class="ability-img-picker" ng-click="UI.modal('#texturePickerMDL');texturePickerInit();">
					<span class="fa fa-edit"></span>
					{{::Locale('Pick')}}
				</a>
			</div>
			<div class="ability-cntr-header-desc">
				<ul class="nav nav-pills pull-right">
					<li class="active">
						<a data-toggle="tab" class="fa fa-file-code-o" href="[data-id='ability']" id="abilityTab"></a>
						<span class="nav-tip">{{::Locale('Ability')}}</span>
					</li>
					<li>
						<a data-toggle="tab" class="fa fa-book" href="[data-id='description']" id="descriptionTab"></a>
						<span class="nav-tip">{{::Locale('Language')}}</span>
					</li>
					<li>
						<a class="fa fa-check-circle-o" ng-click="abilitiesCheck()"></a>
						<span class="nav-tip">{{::Locale('Inspection')}}</span>
					</li>
				</ul>

				<div class="ability-cntr-header-name ability-form">
					<h1>
						{{GC.mainLang().kv.get(Language.abilityAttr(ability._name, ""), Config.global.kvCaseSensitive) || Locale('Unnamed')}}
						<small>
							<a ng-click="UI.modal.rename(ability, renameCheck, renameCallback)">
								<span class="fa fa-edit"></span>
								{{::Locale('Rename')}}
							</a>
							{{ability._name}}
						</small>
					</h1>
				</div>

				<div class="ability-form">
					<span class="ability-tip">{{::Locale('Comment')}}</span>
					<textarea class="ability-form" ng-model="ability._comment" placeholder="{{::Locale('Comment')}}..."></textarea>
				</div>
			</div>
		</div>

		<hr/>

		<!-- ================================================================== -->
		<!-- =                           技能  容器                           = -->
		<!-- ================================================================== -->
		<div class="tab-content ability-cntr-body">
			<div data-id="ability" class="tab-pane fade in active">
				<ul class="nav nav-pills pull-right">
					<li ng-class="{active: !config.get('abilities', ability._name, 'markColor')}">
						<a ng-click="setAbilityMarkColor()"><span class="fa fa-circle" style="color: #CCC;"></span></a>
					</li>
					<li ng-repeat="color in abilityMarkColorList" ng-class="{active: config.get('abilities', ability._name, 'markColor') === color}">
						<a ng-click="setAbilityMarkColor(color)"><span class="fa fa-circle" style="color: {{::color}};"></span></a>
					</li>
				</ul>
				<ul class="nav nav-pills pull-right" style="border-right: 1px solid #666; padding-right: 5px; margin-right: 5px;">
					<li ng-class="{active: !config.get('abilities', ability._name, 'markUsage')}">
						<a uib-tooltip="{{::Locale('NoMark')}}" tooltip-placement="top" tooltip-append-to-body="true"
						   ng-click="setAbilityMarkUsage()">
							<span class="fa fa-ban"></span>
						</a>
					</li>
					<li ng-repeat="item in abilityMarkUsageList" ng-class="{active: config.get('abilities', ability._name, 'markUsage') === item[0]}">
						<a uib-tooltip="{{::Locale(common.text.capitalize(item[0]))}}" tooltip-placement="top" tooltip-append-to-body="true"
						   ng-click="setAbilityMarkUsage(item[0])">
							<span class="fa fa-{{::item[1]}}"></span>
						</a>
					</li>
				</ul>

				<ul class="nav nav-pills">
					<li ng-class="{active: currentTab === 'common'}"><a ng-click="currentTab = 'common'">{{::Locale('Common')}}</a></li>
					<li ng-class="{active: currentTab === 'item'}" ng-show="isItem"><a ng-click="currentTab = 'item'">{{::Locale('Item')}}</a></li>
					<li ng-class="{active: currentTab === 'events'}"><a ng-click="currentTab = 'events'">{{::Locale('Events')}} ({{ability.getEventList().length}})</a></li>
					<li ng-class="{active: currentTab === 'modifiers'}"><a ng-click="currentTab = 'modifiers'">{{::Locale('Modifiers')}} ({{ability.getModifierList().length}})</a></li>
					<li ng-class="{active: currentTab === 'abilitySpecial'}"><a ng-click="currentTab = 'abilitySpecial'">{{::Locale('AbilitySpecial')}} ({{ability.getSpecialList().length}})</a></li>
					<li ng-class="{active: currentTab === 'precache'}"><a ng-click="currentTab = 'precache'">{{::Locale('Precache')}} ({{ability.getPrecacheList().length}})</a></li>
					<li ng-class="{active: currentTab === 'unassigned'}"><a ng-click="currentTab = 'unassigned'">{{::Locale('Unassigned')}} ({{ability.unassignedList.length}})</a></li>
				</ul>

				<div>
					<!-- ====================== 常规 ====================== -->
					<div ng-if="currentTab === 'common'">
						<table class="ability-table">
							<tbody ng-repeat="grpLst in Ability.AttrList track by $index">
							<tr ng-repeat="unit in grpLst track by $index" ng-if="unit.showFunc ? unit.showFunc(this) : true;">
								<th width="200">
									<span class="ability-tip">{{unit.attr}}</span>
									{{::Locale(unit.attr)}}
								</th>
								<td class="ability-form">
									<div kvfield data-ability="ability" data-attrunit="unit" data-srcunit="ability" data-srctmpl="Ability"></div>
								</td>
							</tr>
							</tbody>
						</table>
					</div>

					<!-- ====================== 物品 ====================== -->
					<div ng-if="currentTab === 'item'">
						<table class="ability-table">
							<tbody ng-repeat="grpLst in Ability.ItemAttrList track by $index">
							<tr ng-repeat="unit in grpLst track by $index" ng-if="unit.showFunc ? unit.showFunc(this) : true;">
								<th width="200">
									<span class="ability-tip">{{unit.attr}}</span>
									{{::Locale(unit.attr)}}
								</th>
								<td class="ability-form">
									<div kvfield data-ability="ability" data-attrunit="unit" data-srcunit="ability" data-srctmpl="Ability"></div>
								</td>
							</tr>
							</tbody>
						</table>
					</div>

					<!-- ====================== 事件 ====================== -->
					<div ng-if="currentTab === 'events'" data-id="event">
						<table class="ability-table">
							<tbody ng-repeat="event in ability.getEventList() track by $index">
							<!-- 事件类型 -->
							<tr>
								<th width="120">
									<span class="ability-tip">Event Type</span>
									{{::Locale('EventType')}}
								</th>
								<td class="ability-form" ng-switch="Config.global.eventUseText">
									<input tipfield type="text" ng-model="event.key" data-alternative="Event.EventList" ng-switch-when="true" />
									<select ng-model="event.key" ng-switch-default>
										<option ng-repeat="_event in Event.EventList track by $index" value="{{::_event.value}}">{{::_event.value}} 【{{::Locale(_event.value)}}】</option>
									</select>
								</td>
								<td width="50" class="text-center">
									<a class="fa fa-chevron-up" ng-click="switchEvent(event, ability.getEventList(), ability.kv.value, -1)"></a>
									<a class="fa fa-chevron-down" ng-click="switchEvent(event, ability.getEventList(), ability.kv.value, 1)"></a>
								</td>
								<td width="60" class="text-center">
									<a ng-click="UI.arrayDelete(event, ability.kv.value)">
										Delete
									</a>
								</td>
							</tr>
							<!-- 事件备注 -->
							<tr>
								<th>
									<span class="ability-tip">Comment</span>
									{{::Locale('Comment')}}
								</th>
								<td class="ability-form" colspan="3">
									<textarea ng-model="event.comment" rows="3" placeholder="{{::Locale('Comment')}}"></textarea>
								</td>
							</tr>
							<!-- 操作 -->
							<tr>
								<th>
									<span class="ability-tip">Operation</span>
									{{::Locale('Operation')}}
								</th>
								<td class="ability-form" colspan="3" style="background: #FFF">
									<div ng-if="event.key === 'OnProjectileHitUnit'" class="checkbox">
										<span>{{::Locale('DeleteOnHit')}}</span>
										<span checkbox data-target="event" data-target-path="DeleteOnHit"></span>
									</div>
									<div operationlist="event.value" data-alternative="isItem ? Operation.OperationItemList : Operation.OperationList" data-ability="ability"></div>
								</td>
							</tr>
							</tbody>

							<tbody ng-if="ability.getEventList().length === 0">
							<tr>
								<td>
									<p>{{::Locale('NoEvent')}}</p>
								</td>
							</tr>
							</tbody>
						</table>
						<button class="btn btn-dark" ng-click="addEvent(ability.kv)">+ {{::Locale('NewEvent')}}</button>
					</div>

					<!-- ===================== 修饰器 ===================== -->
					<div ng-show="currentTab === 'modifiers'">
						<ul class="ability-modifer-list nav nav-pills">
							<li class="active" ng-class="{disabled: !_canCopyModifier}">
								<a ng-click="pasteModifier()">
									<span class='fa fa-clipboard'></span>
								</a>
							</li>
							<li class="active">
								<a ng-click="addModifier()">
									+ <span ng-show="!currentModifier">{{::Locale('NewModifier')}}</span>
								</a>
							</li>
							<li ng-repeat="modifier in ability.getModifierList()" ng-class="{active: currentModifier === modifier}">
								<a ng-click="setModifier(modifier)">{{modifier.key}}</a>
								<div class="menu">
									<a ng-click="UI.modal.rename(Modifier(modifier), renameModifierCheck, renameModifierCallback)"><span class="fa fa-pencil"></span> | Rename</a>
									<a ng-click="copyModifier(modifier)"><span class="fa fa-files-o"></span> | Copy</a>
									<a ng-click="UI.arrayDelete(modifier, ability.getModifierList(), delModifierCallback)"><span class="fa fa-trash"></span> | Delete</a>
								</div>
							</li>
						</ul>

						<table class="ability-table" ng-show="currentModifier">
							<!-- Modifier: Common -->
							<tbody ng-repeat="group in Modifier.AttrList track by $index">
								<tr ng-repeat="unit in group track by $index" ng-if="unit.showFunc ? unit.showFunc(currentModifier) : true;">
									<th width="150">
										<span class="ability-tip">{{unit.attr}}</span>
										{{::Locale(unit.attr)}}
									</th>
									<td class="ability-form">
										<!-- TODO: {{unit.link}} -->
										<!-- a class="fa fa-link" ng-if="unit.link && unit.link(currentModifier[unit.attr], ability)" ng-click="unit.link(currentModifier[unit.attr], ability)()"></a -->
										<div kvfield data-ability="ability" data-attrunit="unit" data-srcunit="currentModifier" data-srctmpl="Modifier"></div>
									</td>
								</tr>
							</tbody>

							<!-- Modifier: Prop -->
							<tbody>
								<tr>
									<th>
										<span class="ability-tip">Properties</span>
										{{::Locale('Properties')}}
									</th>
									<td>
										<div class="ability-modifer-prop-list">
											<ul>
												<li ng-repeat="_prop in (currentModifier.get('Properties') || []) track by $index">
													<a ng-click="common.array.remove(_prop, currentModifier.get('Properties'))">[X]</a>
													<div class="ability-modifer-item-select">
														<div class="ability-modifer-item-select-inline" ng-switch="Config.global.operationUseText">
															<input tipfield ng-model="_prop.key" data-alternative="Modifier.Properties" ng-switch-when="true" />
															<select ng-model="_prop.key" ng-switch-default>
																<option ng-repeat="item in Modifier.Properties track by $index" value="{{::item.value}}">
																	{{item.value.replace("MODIFIER_PROPERTY_", "")}} 【{{::Locale(item.value)}}】
																</option>
															</select>
														</div>
													</div>
													<div class="ability-modifer-item-value">
														<input tipfield type="text" class="form-control" ng-model="_prop.value" data-matchfuc="_abilitySpecialMatch" />
													</div>
												</li>
											</ul>
											<a class="add-link" ng-click="currentModifier.assumeKey('Properties', true).value.push(KV.new('', ''))">
												+ {{::Locale('NewProperty')}}
											</a>
										</div>
									</td>
								</tr>
							</tbody>

							<!-- Modifier: State -->
							<tbody>
								<tr>
									<th>
										<span class="ability-tip">States</span>
										{{::Locale('States')}}
									</th>
									<td>
										<div class="ability-modifer-prop-list">
											<ul>
												<li ng-repeat="_state in (currentModifier.get('States') || []) track by $index">
													<a ng-click="common.array.remove(_state, currentModifier.get('States'))">[X]</a>
													<div class="ability-modifer-item-select">
														<div class="ability-modifer-item-select-inline" ng-switch="Config.global.operationUseText">
															<input tipfield ng-model="_state.key" data-alternative="Modifier.States" ng-switch-when="true" />
															<select ng-model="_state.key" ng-switch-default>
																<option ng-repeat="item in Modifier.States track by $index" value="{{::item.value}}">
																	{{item.value.replace("MODIFIER_STATE_", "")}} 【{{::Locale(item.value)}}】
																</option>
															</select>
														</div>
													</div>
													<select ng-model="_state.value">
														<option ng-repeat="item in Modifier.StateValues track by $index" value="{{::item.value}}">
															【{{::Locale(item.value)}}】
															{{item.value.replace("MODIFIER_STATE_VALUE_", "")}}
														</option>
													</select>
												</li>
											</ul>
											<a class="add-link" ng-click="currentModifier.assumeKey('States', true).value.push(KV.new('', ''))">
												+ {{::Locale('NewStates')}}
											</a>
										</div>
									</td>
								</tr>
							</tbody>

							<!-- Modifier: Events -->
							<tbody>
								<tr>
									<th>
										<span class="ability-tip">Events</span>
										{{::Locale('Events')}}
									</th>
									<td style="padding: 5px" data-id="event">
										<table class="ability-table">
											<tbody ng-repeat="event in Modifier(currentModifier).getEventList() track by $index">
											<!-- Event Type -->
											<tr>
												<th width="120">
													<span class="ability-tip">Event Type</span>
													{{::Locale('Event Type')}}
												</th>
												<td class="ability-form" ng-switch="Config.global.eventUseText">
													<input tipfield type="text" ng-model="event.key" data-alternative="Event.ModifierEventList" ng-switch-when="true" />
													<select ng-model="event.key" ng-switch-default>
														<option ng-repeat="_event in Event.ModifierEventList track by $index" value="{{::_event.value}}">{{::_event.value}} 【{{::Locale(_event.value)}}】</option>
													</select>
												</td>
												<td width="50" class="text-center">
													<a class="fa fa-chevron-up" ng-click="switchEvent(event, Modifier(currentModifier).getEventList(), currentModifier.value, -1)"></a>
													<a class="fa fa-chevron-down" ng-click="switchEvent(event, Modifier(currentModifier).getEventList(), currentModifier.value, 1)"></a>
												</td>
												<td width="60" class="text-center">
													<a href="javascript:void(0)" ng-click="UI.arrayDelete(event, currentModifier.value)">
														Delete
													</a>
												</td>
											</tr>

											<!-- Event Thinking Interval -->
											<tr ng-if="event.key === 'OnIntervalThink'">
												<th>
													<span class="ability-tip">ThinkInterval</span>
													{{::Locale('ThinkInterval')}}
												</th>
												<td class="ability-form" colspan="3">
													<input ng-model="currentModifier.bind('ThinkInterval')" ng-model-options="{getterSetter: true}" />
												</td>
											</tr>

											<!-- Event Comment -->
											<tr>
												<th>
													<span class="ability-tip">Comment</span>
													{{::Locale('_comment')}}
												</th>
												<td class="ability-form" colspan="3">
													<textarea ng-model="event.comment" rows="3" placeholder="{{::Locale('_comment')}}"></textarea>
												</td>
											</tr>

											<!-- Event Operation -->
											<tr>
												<th>
													<span class="ability-tip">Operation</span>
													{{::Locale('Operation')}}
												</th>
												<td class="ability-form" colspan="3" style="background: #FFF">
													<div ng-if="event.key === 'OnProjectileHitUnit'" class="checkbox">
														<span>{{::Locale('DeleteOnHit')}}</span>
														<span checkbox data-target="event" data-target-path="DeleteOnHit"></span>
													</div>
													<div operationlist="event.value" data-alternative="isitem ? Operation.OperationItemList : Operation.OperationList" data-ability="ability"></div>
												</td>
											</tr>
											</tbody>
										</table>

										<a ng-click="addEvent(currentModifier)">+ {{::Locale('NewEvent')}}</a>
									</td>
								</tr>
							</tbody>
						</table>

						<p ng-if="ability._modifierList.length === 0">No Modifier 【没有修饰器】</p>
					</div>

					<!-- ==================== PreCache ==================== -->
					<div ng-if="currentTab === 'precache'">
						<table class="ability-table">
							<thead>
								<tr>
									<th width="34"></th>
									<th width="150">{{::Locale('Type')}}</th>
									<th>{{::Locale('Value')}}</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="_precache in ability.getPrecacheList() track by $index">
									<th>
										<a ng-click="common.array.remove(_precache, ability.kv.get('precache'))">[X]</a>
									</th>
									<td class="ability-form">
										<select ng-model="_precache.key">
											<option ng-repeat="_type in ['particle','soundfile','model','particle_folder','soundfile_folder','model_folder']">{{_type}}</option>
										</select>
									</td>
									<td class="ability-form">
										<input type="text" ng-model="_precache.value" />
									</td>
								</tr>
								<!-- Empty List -->
								<tr ng-if="ability.getPrecacheList().length === 0">
									<td colspan="3">
										<p>{{::Locale('NoPrecache')}}</p>
									</td>
								</tr>
							</tbody>
						</table>
						<p class="text-info">* {{::Locale('originNoPrecache')}}</p>
						<button class="btn btn-dark" ng-click="ability.kv.assumeKey('precache', true).value.push(KV.new('particle'))">+ {{::Locale('NewKV')}}</button>
					</div>

					<!-- ==================== Ability Special ==================== -->
					<div ng-if="currentTab === 'abilitySpecial'">
						<table class="ability-table">
							<thead>
								<tr>
									<th width="70"></th>
									<th>{{::Locale('Key')}}</th>
									<th>{{::Locale('Type')}}</th>
									<th>{{::Locale('Value')}}</th>
									<th>{{::Locale('LinkedSpecialBonus')}}</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="_abilitySpecial in ability.getSpecialList() track by $index">
									<th class="text-center">
										<a class="fa fa-trash" ng-click="UI.arrayDelete(_abilitySpecial, ability.kv.get('AbilitySpecial'))"></a> |
										<a class="fa fa-chevron-up" ng-click="common.array.moveOffset(_abilitySpecial, ability.kv.get('AbilitySpecial'), -1)"></a>
										<a class="fa fa-chevron-down" ng-click="common.array.moveOffset(_abilitySpecial, ability.kv.get('AbilitySpecial'), 1)"></a>
									</th>
									<td class="ability-form">
										<input type="text" ng-model="_abilitySpecial.value[1].key" />
									</td>
									<td class="ability-form">
										<select ng-model="_abilitySpecial.value[0].value">
											<option ng-repeat="type in Ability.AbilitySpecialType track by $index" value="{{::type[0]}}">
												{{::type[0]}}
												【{{::Locale(type[0])}}】
											</option>
										</select>
									</td>
									<td class="ability-form">
										<input type="text" ng-model="_abilitySpecial.value[1].value" />
									</td>
									<td class="ability-form">
										<input type="text" ng-model="_abilitySpecial.value[2].value" />
									</td>
								</tr>
								<tr ng-if="ability.getSpecialList().length === 0">
									<td colspan="4">
										<p>{{::Locale('NoSpecialValue')}}</p>
									</td>
								</tr>
							</tbody>
						</table>

						<button class="btn btn-dark" ng-click="addAbilitySpecial()">+ {{::Locale('NewKV')}}</button>
					</div>

					<!-- ==================== Unassigned KV ==================== -->
					<div ng-if="currentTab === 'unassigned'">
						<table class="ability-table">
							<tbody>
								<tr ng-repeat="kv in ability.unassignedList track by $index">
									<th width="35" class="text-center">
										<a ng-click="UI.arrayDelete(kv, ability.kv.value, refreshUnassigned)">[X]</a>
									</th>
									<td class="ability-form" style="padding-left: 5px;">
										<div kvtree="kv" data-keyeditable="false" data-open="true"></div>
									</td>
								</tr>
								<!-- Empty List -->
								<tr ng-if="ability.unassignedList.length === 0">
									<td>
										<p>{{::Locale('NoUnassigned')}}</p>
									</td>
								</tr>
							</tbody>
						</table>

						<button class="btn btn-dark" ng-click="newUnassigned()">+ {{::Locale('New')}}</button>
					</div>

				</div>
			</div>

			<!-- ============================================== -->
			<!-- =                    描述                    = -->
			<!-- ============================================== -->
			<div data-id="description" class="tab-pane fade">
				<!-- No Language File -->
				<div ng-show="GC.languageList.length === 0">
					<h3>{{::Locale('noLanguageFile')}}</h3>
				</div>

				<!-- Has Language File -->
				<div class="row" ng-show="languageList.length !== 0">
					<div class="col-md-2">
						<div class="listCntr">
							<div ng-repeat="_lang in GC.languageList track by $index" class="listItem"
							     ng-class="{active: GC.currentLanguage == _lang}" ng-click="GC.currentLanguage = _lang;">
								<p>{{_lang.name}}</p>
							</div>
						</div>
					</div>
					<div class="col-md-10">
						<p ng-show="!language.ready">Loading...</p>

						<!-- ========================= -->
						<!-- =      Description      = -->
						<!-- ========================= -->
						<div ng-if="language && ability">
							<h3>Description 【描述】</h3>
							<table class="ability-table" ng-show="language.ready">
								<tbody>
									<!-- 常规描述 -->
									<tr ng-repeat="langField in Language.AbilityLang track by $index">
										<th width="150">
											<span class="ability-tip">{{langField.attr || langField.title}}</span>
											{{langField.desc}}
										</th>
										<td>
											<button class="btn btn-default fa fa-paint-brush color-picker"></button>
											<input type="text" ng-model="GC.currentLanguage.kv.bind(Language.abilityAttr(ability._name, langField.attr))"
											       ng-model-options="{getterSetter: true}" class="form-control" ng-if="langField.type === 'text'"/>
											<textarea ng-model="GC.currentLanguage.kv.bind(Language.abilityAttr(ability._name, langField.attr))" rows="{{langField.rows || 3}}"
											          ng-model-options="{getterSetter: true}" class="form-control" ng-if="langField.type === 'blob'"></textarea>
										</td>
									</tr>

									<!-- 自定义值 -->
									<tr>
										<th colspan="2" class="success">
											AbilitySpecial 【自定义值】
										</th>
									</tr>
									<tr ng-repeat="_abilitySpecial in ability.getSpecialList() track by $index">
										<th>{{_abilitySpecial.value[1].key}}</th>
										<td>
											<button class="btn btn-default fa fa-paint-brush color-picker"></button>
											<input type="text" ng-model="GC.currentLanguage.kv.bind(Language.abilityAttr(ability._name, _abilitySpecial.value[1].key))"
											       ng-model-options="{getterSetter: true}" class="form-control" />
										</td>
									</tr>
								</tbody>
							</table>

							<!-- ========================== -->
							<!-- =         修饰器         = -->
							<!-- ========================== -->
							<h3>Modifiers 【修饰器】</h3>
							<table class="ability-table" ng-show="language.ready">
								<tbody ng-repeat="modifier in ability.getModifierList() track by $index">
									<tr>
										<th colspan="2" class="success">
											<span class="glyphicon glyphicon-tag"></span> {{modifier.key}}
											<span ng-if="modifier.get('IsHidden') === '1'" class="label label-info">{{::Locale('Hidden')}}</span>
										</th>
									</tr>
									<tr ng-repeat="langField in Language.ModifierLang track by $index">
										<th width="150">
											<span class="ability-tip">{{langField.attr || langField.title}}</span>
											{{langField.desc}}
										</th>
										<td>
											<button class="btn btn-default fa fa-paint-brush color-picker"></button>
											<input type="text" ng-model="GC.currentLanguage.kv.bind(Language.modifierAttr(modifier.key, langField.attr))"
											       ng-model-options="{getterSetter: true}" class="form-control" ng-if="langField.type === 'text'"/>
											<textarea ng-model="GC.currentLanguage.kv.bind(Language.modifierAttr(modifier.key, langField.attr))"
											          ng-model-options="{getterSetter: true}" class="form-control" ng-if="langField.type === 'blob'"></textarea>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


<!-- ====================================================================== -->
<!-- =                               Search                               = -->
<!-- ====================================================================== -->
<div class="top-box" ng-show="searchBox">
	<div class="row">
		<div class="col-md-12">
			<input tipfield type="text" id="search" data-matchfuc="searchMatch" ng-model="searchKey"
			       class="form-control" placeholder="{{::Locale('Search')}}..." ng-keyup="searchPress($event)">
		</div>
	</div>
</div>

<!-- ====================================================================== -->
<!-- =                              技能菜单                              = -->
<!-- ====================================================================== -->
<ul id="abilityMenu" class="app-menu app-float-menu">
	<li><a ng-click="setAbilityEditorAlias()">{{::Locale('EditorAlias')}}</a></li>
	<li class="app-submenu">
		<a>{{::Locale('UsageMarker')}}</a>
		<ul class="app-menu">
			<li><a ng-click="setAbilityMarkUsage('dummy');">{{::Locale('Dummy')}}</a></li>
			<li><a ng-click="setAbilityMarkUsage('test');">{{::Locale('Test')}}</a></li>
			<li class="line"></li>
			<li><a ng-click="setAbilityMarkUsage();">{{::Locale('NoMark')}}</a></li>
		</ul>
	</li>
	<li class="app-submenu">
		<a>{{::Locale('ColorMarker')}}</a>
		<ul class="app-menu">
			<li><a ng-click="setAbilityMarkColor('#00a65a');"><span class="fa fa-circle sm" style="color: #00a65a;"></span> {{::Locale('Green')}}</a></li>
			<li><a ng-click="setAbilityMarkColor('#00c0ef');"><span class="fa fa-circle sm" style="color: #00c0ef;"></span> {{::Locale('Blue')}}</a></li>
			<li><a ng-click="setAbilityMarkColor('#dd4b39');"><span class="fa fa-circle sm" style="color: #dd4b39;"></span> {{::Locale('Red')}}</a></li>
			<li><a ng-click="setAbilityMarkColor('#f39c12');"><span class="fa fa-circle sm" style="color: #f39c12;"></span> {{::Locale('Yellow')}}</a></li>
			<li><a ng-click="setAbilityMarkColor('#666666');"><span class="fa fa-circle sm" style="color: #666666;"></span> {{::Locale('Black')}}</a></li>
			<li class="line"></li>
			<li><a ng-click="setAbilityMarkColor();"><span class="fa fa-circle sm" style="color: #cccccc;"></span> {{::Locale('None')}}</a></li>
		</ul>
	</li>
	<li><a ng-click="copyAbility()">{{::Locale('Duplicate')}}</a></li>
	<li class="line"></li>
	<li><a ng-click="deleteAbility()" class="danger">{{::Locale('Delete')}}</a></li>
</ul>

<!-- ====================================================================== -->
<!-- =                             Modal List                             = -->
<!-- ====================================================================== -->
<!-- New Unit -->
<div class="modal fade" id="newAbilityMDL" tabindex="-1">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">{{::Locale('New')}}</h4>
			</div>
			<div class="modal-body">
				<div class="form-group" ng-show="_newAbilityFork">
					<label>* {{::Locale('OldName')}}</label>
					<input type="text" class="form-control" ng-model="_newAbilityFork._name" disabled="disabled" />
				</div>
				<div class="form-group">
					<label>* {{::Locale('Name')}}</label>
					<input type="text" class="form-control" ng-model="_newAbilityName"/>
				</div>
				<div class="checkbox" ng-show="_newAbilityFork">
					<label>
						<input type="checkbox" ng-checked="_newAbilityForkLang" ng-click="_newAbilityForkLang = !_newAbilityForkLang"> {{::Locale('ForkLang')}}
					</label>
				</div>

				<!-- Modifier List -->
				<table class="table table-bordered" ng-if="_newAbilityFork">
					<thead>
						<tr>
							<th>{{::Locale('OriginalModifierName')}}</th>
							<th>{{::Locale('TargetModifierName')}}</th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="_modifier in _newAbilityFork.getModifierList() track by $index">
							<td style="vertical-align: middle;">{{_modifier.key}}</td>
							<td><input class="form-control" ng-model="_newAbilityForkModiers[_modifier.key]" /></td>
						</tr>
					</tbody>
				</table>
				<p class="text-muted" ng-show="_newAbilityFork">* {{::Locale('forkModifierNewName')}}</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" ng-click="confirmNewEntity()">OK</button>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="newTmplMDL" tabindex="-1">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">{{::Locale('New')}}</h4>
			</div>
			<div class="modal-body">
				<ul id="newTmplNav" class="nav nav-tabs">
					<li data-type="template" class="active"><a href="[data-id='tmplAbility']" data-toggle="tab">Template</a></li>
					<li data-type="spellLib"><a href="[data-id='spellLib']" data-toggle="tab">Spell Library</a></li>
				</ul>
				<br/>

				<div class="tab-content">
					<div class="tab-pane fade in active" data-id="tmplAbility">
						<!-- Template Ability -->
						<div class="form-group">
							<label>{{::Locale('Name')}}</label>
							<input type="text" class="form-control" ng-model="_newTmplAbility._name" />
						</div>
						<div class="form-group">
							<label>{{::Locale('Type')}}</label>
							<select class="form-control" ng-model="_newTmplAbility._type">
								<option ng-repeat="_type in _newTmplAbility.type" value="{{::_type}}">{{::Locale(_type)}} 【{{::_type}}】</option>
							</select>
						</div>
						<div class="form-group" ng-show="_newTmplAbility._type !== 'Passive'">
							<label>{{::Locale('Target')}}</label>
							<select class="form-control" ng-model="_newTmplAbility._target">
								<option ng-repeat="_target in _newTmplAbility.target" value="{{::_target}}">{{::Locale(_target)}} 【{{::_target}}】</option>
							</select>
						</div>
						<div class="checkbox" ng-show="_newTmplAbility._type !== 'Passive'">
							<label>
								<input type="checkbox" ng-checked="_newTmplAbility._channelled" ng-click="_newTmplAbility._channelled = !_newTmplAbility._channelled;"> {{::Locale('Channelled')}}
							</label>
						</div>
						<div class="checkbox" ng-show="isItem">
							<label uib-tooltip="{{::Locale('itemAutoIDTip')}}" tooltip-placement="right" tooltip-append-to-body="true">
								<input type="checkbox" ng-checked="_newTmplAbility._autoID" ng-click="_newTmplAbility._autoID = !_newTmplAbility._autoID;">
								{{::Locale('itemAutoID')}}
							</label>
						</div>
					</div>

					<div class="tab-pane fade" data-id="spellLib">
						<!-- Spell Library Ability -->
						<p ng-if="spellLibList.length === 0" class="text-warning">{{::Locale('spellLibraryEmpty')}}</p>
						<div class="row" ng-show="spellLibList.length">
							<div class="col-sm-6">
								<div class="form-group">
									<input type="text" class="form-control" ng-model="spellLibFilter" placeholder="{{::Locale('Filter')}}" />
								</div>
								<select multiple class="form-control" ng-model="spellLibItem" ng-change="updateSpellLib()"
										style="min-height: 400px;">
									<option ng-repeat="spell in spellLibList | filter:spellLibFilter track by $index" value="{{spell}}">
										{{spell.replace("_datadriven.txt", "")}}
									</option>
								</select>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<a class="fa fa-eye pull-right" ng-show="spellLibItem[0]" ng-click="spellLibPreview(spellLibItem[0])"></a>
									<label>{{::Locale('Template')}}</label>
									<input type="text" class="form-control" ng-model="spellLibItem[0]" readonly />
								</div>

								<div class="form-group">
									<label>{{::Locale('Name')}}</label>
									<input type="text" class="form-control" ng-model="_newTmplAbility._name" />
								</div>

								<p ng-if="spellLibItem[0] && !spellLibCache[spellLibItem[0]].ready">
									<span class="fa fa-spin fa-refresh"></span>
									{{::Locale('Loading')}}...
								</p>
								<div ng-if="spellLibItem[0] && spellLibCache[spellLibItem[0]].requireScript">
									<hr/>
									<label>{{::Locale('AdditionalDependency')}}</label>
									<div class="form-group" ng-repeat="(key, value) in spellLibCache[spellLibItem[0]].scripts track by $index">
										<label>{{key}}</label>
										<input type="text" class="form-control" ng-model="spellLibCache[spellLibItem[0]].scripts[key]" />
									</div>
									<p class="text-warning">
										* {{::Locale('spellLibraryScripts')}}
										<a href="https://github.com/Pizzalol/SpellLibrary/blob/master/game/scripts/vscripts/addon_game_mode.lua" target="_blank">
											Spell Library - addon_game_mode.lua
										</a>
									</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">{{::Locale('Close')}}</button>
				<button type="button" class="btn btn-primary" ng-click="newTmplAbility.confirm()">{{::Locale('Create')}}</button>
			</div>
		</div>
	</div>
</div>



<!-- New Unassigned -->
<div class="modal fade" id="newUnassignedMDL" tabindex="-1">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">{{::Locale('NewKV')}}</h4>
			</div>
			<div class="modal-body">
				<div class="form-group">
					<label>* {{::Locale('Key')}}</label>
					<input type="text" class="form-control" ng-model="_newUnassignedKey"/>
				</div>
				<div class="form-group">
					<label>{{::Locale('Value')}}</label>
					<input type="text" class="form-control" ng-model="_newUnassignedValue"/>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" ng-click="confirmNewUnassigned()">OK</button>
			</div>
		</div>
	</div>
</div>



<!-- Check report -->
<div class="modal fade" id="checkReportMDL" tabindex="-1">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<input type="text" class="form-control pull-right" style="width: 30%;"
				       ng-model="checkReportFilter" ng-change="checkReportFilterChange()" placeholder="{{::Locale('Filter')}}" />

				<h4 class="modal-title">{{::Locale('CheckReport')}}</h4>
			</div>
			<div class="modal-body">
				<ul>
					<li ng-repeat="item in checkReportFilteredList track by $index">
						[{{item.language.name}}]
						<a ng-click="setAbility(item.ability);" class="fa fa-link"></a>
						<b>{{item.ability._name}}</b>,

						<!-- Tips -->
						<span ng-if="!item.modifier"><span class="text-info">{{item.langField.attr || 'Title'}}</span> miss</span>
						<span ng-if="item.modifier">
							Modifier:
							<b class="text-success">{{item.modifier.key}}</b>
							<span class="text-info">{{item.langField.attr || 'Title'}}</span>
							miss
						</span>
						<a class="fa fa-pencil-square" ng-click="item.showEdit = !item.showEdit"></a>
						<span class="fa fa-check text-success" ng-if="!item.modifier && item.language.kv.get(Language.abilityAttr(item.ability._name, item.langField.attr))"></span>
						<span class="fa fa-check text-success" ng-if="item.modifier && item.language.kv.get(Language.modifierAttr(item.modifier.key, item.langField.attr))"></span>

						<!-- Editable -->
						<div ng-if="item.showEdit">
							<textarea ng-model="item.language.kv.bind(Language.abilityAttr(item.ability._name, item.langField.attr))"
							          ng-model-options="{getterSetter: true}" class="form-control" ng-if="!item.modifier"></textarea>
							<textarea ng-model="item.language.kv.bind(Language.modifierAttr(item.modifier.key, item.langField.attr))"
							          ng-model-options="{getterSetter: true}" class="form-control" ng-if="item.modifier"></textarea>
						</div>
					</li>
				</ul>
				<p ng-show="checkReportFilteredList.length === 0" class="text-success">{{::Locale('NothingNeedFix')}}</p>
				<p ng-hide="checkReportFilteredList.length === 0" class="text-muted">{{::Locale('reportLimit')}}</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<!-- Texture Picker View -->
<div class="modal" id="texturePickerMDL" tabindex="-1">
	<div class="modal-dialog modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">
					{{::Locale('TexturePicker')}}
				</h4>
			</div>
			<div class="modal-body">
				<input type="text" class="form-control pull-right" style="width: 250px" placeholder="filter..." ng-model="texturePickerFilter" />
				<ul class="nav nav-tabs">
					<li class="active"><a href="[data-id='texturePickerOfficial']" data-toggle="tab">Official</a></li>
					<li><a href="[data-id='texturePickerCustomize']" data-toggle="tab">Customize</a></li>
				</ul>

				<div id="myTabContent" class="tab-content ability-textureCntr" ng-class="{ability: !isItem, item: isItem}">
					<div class="tab-pane fade in active" data-id="texturePickerOfficial">
						<p class="text-warning" ng-if="texturePickerList.length === 0">{{::Locale('texturePickerEmpty')}}</p>
						<div class="clearfix">
							<div ng-repeat="img in texturePickerList track by $index" class="ability-texture"
								 ng-mouseenter="texturePickerPreview($event, AppVersionSrv.resPath + 'res/' + texturePath + '/' + img)"
								 ng-mouseleave="texturePickerPreview($event, '')"
								 ng-click="selectTexture(img)" ng-show="texturePickerMatch(img)">
								<img ng-src="{{AppVersionSrv.resPath + 'res/' + texturePath + '/' + img}}">
							</div>
						</div>
					</div>
					<div class="tab-pane fade" data-id="texturePickerCustomize">
						<p class="text-warning" ng-if="texturePickerCustomizeList.length === 0">{{::Locale('texturePickerCustomizeEmpty')}}</p>
						<div class="clearfix">
							<div ng-repeat="img in texturePickerCustomizeList track by $index" class="ability-texture"
								 ng-mouseenter="texturePickerPreview($event, Config.projectPath + '/resource/flash3/images/' + texturePath + '/' + img)"
								 ng-mouseleave="texturePickerPreview($event, '')"
								 ng-click="selectTexture(img)" ng-show="texturePickerMatch(img)">
								<img ng-src="{{Config.projectPath + '/resource/flash3/images/' + texturePath + '/' + img}}">
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
			</div>
		</div>
	</div>
</div>

<div class="ability-textureCntr-preview" ng-show="texturePickerPreviewPath">
	<img ng-src="{{texturePickerPreviewPath}}">
</div>